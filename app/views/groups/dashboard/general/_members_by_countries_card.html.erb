<canvas id="top3_departments_bars"></canvas>
<% content_for :after_js do %>
  <script>
    var ctx = document.getElementById("top3_departments_bars").getContext("2d");
    var data = {
      //labels: <%= raw KpiDash.new(@group, 'top3_departments_labels').call.to_json %>,
      labels: ['France', 'Australia', 'United Kingdom'],
      datasets: [
        {
          label: "Active members by department",
          backgroundColor: [
            'rgba(33,47,59, 0.7)',
            'rgba(255,112,166, 0.7)',
            'rgba(255, 206, 86, 0.7)',
          ],
          borderColor: [
            'rgba(33,47,59,1)',
            'rgba(255,112,166, 1)',
            'rgba(255, 206, 86, 1)',
          ],
          borderWidth: 1,
          data: <%=
            countries_active_members = KpiDash.new(@group, 'countries_active_members').call
            top_countries = countries_active_members.map do |country, active_members|
              active_members
            end
            top_countries[0..2]
          %>,
          // data: [12, 9, 8],
        }
      ]
    };

    var myBarChart = new Chart(ctx, {
        type: 'bar',
        data: data,
        options: {
          maintainAspectRatio: false,
          responsive: true,
          legend: {
            display: false,
            labels: {
                display: false
            }
          },
          scales: {
            yAxes: [{
              labels: {
                display: false,
                fontColor: 'white',
                fontSize: 15
              },
              barThickness: 50,
              ticks: {
                beginAtZero:true,
                fontColor: 'white',
                fontSize: 15
              }
            }],
            xAxes: [{
              barThickness: 50,
              ticks: {
                beginAtZero:true,
                fontColor: 'white',
                fontSize: 15
              }
            }]
          }
        }
    });
  </script>
<% end %>
